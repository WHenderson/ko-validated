!function(e,r){"function"==typeof define&&define.amd?define(["knockout"],r):e.ko=r(e.ko)}(this,function(e){var r,n={}.hasOwnProperty;return r=function(e){var r,t,o,i;return e.validated={},r=function(){function e(e,r,n,t,o){this.name=e,this.message=r,this.target=n,null!=t&&(this.dispose=t),null!=o&&(this.isDisposed=o)}return e.prototype.dispose=function(){},e.prototype.isDisposed=function(){return!0},e}(),t=0,i=function(){return++t},e.extenders.fallible=function(t,o){var l,s,u,f,a,c;return o===!1?("function"==typeof t._disposeFallible&&t._disposeFallible(),t):e.extenders.fallible.isFallible(t)?t:(s=e.observable({}),f={},u={}.hasOwnProperty,c=function(e,r){var n,t;"string"==typeof e&&({}.hasOwnProperty(f,e)?(t=e,e=f[e],delete f[t]):e=void 0),null!=e&&(n=s(),u.call(n,e)&&(delete n[e],r!==!1&&s.valueHasMutated()))},l=function(e){return u.call(s(),e)},a=function(e,n,o,u){var a,d;return null!=n?(d=i(),a=new r(o,n,t,function(){return c(null!=o?o:d)},function(){return!l(d)}),"string"==typeof o&&({}.hasOwnProperty.call(f,o)&&c(f[o],!1),f[o]=d),e[d]=n,u!==!1&&s.valueHasMutated()):(a=new r(o,n,t),c(o,u)),a},t.errors=e.pureComputed({read:function(){var e,r,t,o,i;o=[],e=function(r){var n,t,i;if(null!=r)if("function"==typeof r)r=r(),e(r);else if(Array.isArray(r))for(n=0,t=r.length;t>n;n++)i=r[n],e(i);else"string"==typeof r||"object"==typeof r?o.push(r):"undefined"!=typeof console&&null!==console&&"function"==typeof console.assert&&console.assert(!1,"invalid error message")},i=s();for(r in i)n.call(i,r)&&(t=i[r],e(t));return o},write:function(e){t.errors.set(e)}}),t.errors.add=function(e,r){return 1===arguments.length&&(r=e,e=void 0),a(s(),r,e,!0)},t.errors.set=function(e,r){var n,t;return 1===arguments.length&&(r=e,e=void 0),t={},f={},n=a(t,r,e,!1),s(t),n},t.errors.get=function(e){var r,t,o,i,l;if(t=void 0,r=function(e){var n,o,i;if(null==e)return!1;if("function"==typeof e){if(e=e(),r(e))return!0}else if(Array.isArray(e)){for(n=0,o=e.length;o>n;n++)if(i=e[n],r(i))return!0}else{if("string"==typeof e||"object"==typeof e)return t=e,!0;"undefined"!=typeof console&&null!==console&&"function"==typeof console.assert&&console.assert(!1,"invalid error message")}return!1},"string"==typeof e){if({}.hasOwnProperty.call(f,e)&&r(s()[f[e]]))return t}else{l=s();for(o in l)if(n.call(l,o)&&(i=l[o],r(i)))return t}},t.errors.has=function(e){return null!=t.errors.get(e)},t.errors.remove=function(e){"string"==typeof e&&c(e)},t.errors.clear=function(){f={},s({})},t.error=e.pureComputed({read:t.errors.get,write:t.errors.set}),t.hasError=e.pureComputed({read:t.errors.has}),t._disposeFallible=function(){s({}),delete t.error,delete t.errors,delete t.hasError,delete t._disposeFallible},t)},e.extenders.fallible.isFallible=function(e){return null!=e.errors&&null!=e.error},o=function(){var r,t;return t=function(){var r,n,t,o,i;if(r=e.computed(function(){}),null!=Object.getOwnPropertySymbols)for(o=Object.getOwnPropertySymbols(r),n=0,t=o.length;t>n;n++)if(i=o[n],"Symbol(_state)"===String(i))return i;return{}.hasOwnProperty.call(r,"_state")?"_state":void 0}(),r=function(){var r,o,i,l,s;i=e.observable(),r=e.computed({read:function(){return i()}}),l=r[t];for(o in l)if(n.call(l,o)&&(s=l[o],null!=s&&"object"==typeof s))return o}(),function(n){return e.isComputed(n)?n[t][r]:{}}}(),e.extenders.fallibleRead=function(r,t){var i,l,s;return e.isComputed(r)?(r.extend({fallible:!0}),t===!1?void("function"==typeof r._disposeFallibleRead&&r._disposeFallibleRead()):(s=function(r,t){var i,l,u;u=o(t);for(l in u)n.call(u,l)&&(i=u[l],i=i._target,e.extenders.fallible.isFallible(i)&&-1===r.indexOf(i.errors)&&r.push(i.errors),e.isComputed(i)&&s(r,i));return r},l=function(){try{return s([],r)}finally{}},i=r.errors.add(l),r._disposeFallibleRead=function(){null!=i&&(i.dispose(),i=void 0)},r)):r},e},r(e),e});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImtvLXZhbGlkYXRlZC5hcHBsaWVkLndlYi5qcyIsImtvLXZhbGlkYXRlZC5hcHBsaWVkLmNvZmZlZSJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImtvIiwidGhpcyIsImFwcGx5S292IiwiaGFzUHJvcCIsImhhc093blByb3BlcnR5IiwiRGlzcG9zYWJsZSIsIl9pZENvdW50ZXIiLCJnZXREZXBlbmRlbmNpZXMiLCJnZXRVbmlxdWVJZCIsInZhbGlkYXRlZCIsIm5hbWUxIiwibWVzc2FnZTEiLCJ0YXJnZXQxIiwiZGlzcG9zZSIsImlzRGlzcG9zZWQiLCJuYW1lIiwibWVzc2FnZSIsInRhcmdldCIsInByb3RvdHlwZSIsImV4dGVuZGVycyIsImZhbGxpYmxlIiwib3B0aW9ucyIsIl9lcnJvckV4aXN0cyIsIl9lcnJvcnMiLCJfaGFzT3duUHJvcCIsIl9uYW1lZCIsIl9yZWdpc3RlckVycm9yIiwiX3JlbW92ZUVycm9yIiwiX2Rpc3Bvc2VGYWxsaWJsZSIsImlzRmFsbGlibGUiLCJvYnNlcnZhYmxlIiwiaWQiLCJ0cmlnZ2VyIiwiZXJyb3JzIiwiY2FsbCIsInZhbHVlSGFzTXV0YXRlZCIsImRpc3Bvc2FibGUiLCJwdXJlQ29tcHV0ZWQiLCJyZWFkIiwiY29sbGVjdE1lc3NhZ2VzIiwibWVzc2FnZXMiLCJyZWYiLCJpIiwibGVuIiwic3ViTWVzc2FnZSIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInB1c2giLCJjb25zb2xlIiwiYXNzZXJ0Iiwid3JpdGUiLCJzZXQiLCJhZGQiLCJhcmd1bWVudHMiLCJnZXQiLCJmaW5kTWVzc2FnZSIsImZpcnN0TWVzc2FnZSIsImhhcyIsInJlbW92ZSIsImNsZWFyIiwiZXJyb3IiLCJoYXNFcnJvciIsImRlcEtleSIsInN5bVN0YXRlIiwiYyIsInN5bWJvbCIsImNvbXB1dGVkIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwiU3RyaW5nIiwia2V5IiwibyIsInZhbCIsImlzQ29tcHV0ZWQiLCJmYWxsaWJsZVJlYWQiLCJmaW5kSW5uZXIiLCJleHRlbmQiLCJfZGlzcG9zZUZhbGxpYmxlUmVhZCIsIm91dHB1dCIsImRlcGVuZGVuY3kiLCJfdGFyZ2V0IiwiaW5kZXhPZiJdLCJtYXBwaW5ncyI6IkNBQUUsU0FBU0EsRUFBTUMsR0FDTyxrQkFBWEMsU0FBeUJBLE9BQU9DLElBQ3pDRCxRQUFRLFlBQWFELEdBRXJCRCxFQUFLSSxHQUFLSCxFQUFRRCxFQUFLSSxLQUV6QkMsS0FBTSxTQUFVRCxHQUNsQixHQUFJRSxHQ1BKQyxLQUFBQyxjRCtVQSxPQy9VQUYsR0FBVyxTQUFDRixHQUNWLEdBQUFLLEdBQUFDLEVBQUFDLEVBQUFDLENBbVNBLE9BblNBUixHQUFHUyxhQUdHSixFQUFBLFdBQ1MsUUFBQUEsR0FBQ0ssRUFBT0MsRUFBVUMsRUFBU0MsRUFBU0MsR0FBbkNiLEtBQUNjLEtBQURMLEVBQU9ULEtBQUNlLFFBQURMLEVBQVVWLEtBQUNnQixPQUFETCxFQUMxQixNQUFBQyxJQUNEWixLQUFDWSxRQUFVQSxHQUNWLE1BQUFDLElBQ0RiLEtBQUNhLFdBQWFBLEdEdUJsQixNQU5BVCxHQUFXYSxVQ2ZYTCxRQUFTLGFEaUJUUixFQUFXYSxVQ2RYSixXQUFZLFdBQ1YsT0FBTyxHRGlCRlQsS0NmVEMsRUFBYSxFQUNiRSxFQUFjLFdEbUJaLFFDbEJFRixHQUVKTixFQUFHbUIsVUFBVUMsU0FBVyxTQUFDSCxFQUFRSSxHQUUvQixHQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxDQUFBLE9BQUdOLE1BQVcsR0RtQjJCLGtCQUE1QkosR0FBT1csa0JDbEJsQlgsRUFBT1csbUJBQ0FYLEdBR05qQixFQUFHbUIsVUFBVUMsU0FBU1MsV0FBV1osR0FDM0JBLEdBR1RNLEVBQVV2QixFQUFHOEIsZUFDYkwsS0FHQUQsS0FBbUJwQixlQUduQnVCLEVBQWUsU0FBQ0ksRUFBSUMsR0FDbEIsR0FBQUMsR0FBQWxCLENBQWdCLGlCQUFOZ0IsUUFDRjNCLGVBQWVxQixFQUFRTSxJ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M0I4QyxFQUFPL0IsS0FBS2dDLEVBQVcvQyxRQUV4QmpDLEVBQUcwRSxXQUFXTSxJQUNmSixFQUFVRyxFQUFRQyxHQUV0QixPQUFPRCxJQUVUOUMsRUFBUyxXQUNQLElBR0UsTUFBTzJDLE1BQWMzRCxHQUh2QixXQU9GbUIsRUFBYW5CLEVBQU9nQixPQUFPb0IsSUFBSXBCLEdBRS9CaEIsRUFBTzZELHFCQUF1QixXQUN6QixNQUFBMUMsSUFDREEsRUFBV3ZCLFVBQ1h1QixFQUFhLFNBR1ZuQixJQXBDRUEsR0F1Q0pqQixHQUVURSxFQUFTRixHRHlDRkEiLCJmaWxlIjoia28tdmFsaWRhdGVkLmFwcGxpZWQud2ViLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24ocm9vdCwgZmFjdG9yeSkge1xyXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgIGRlZmluZShbJ2tub2Nrb3V0J10sIGZhY3RvcnkpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByb290LmtvID0gZmFjdG9yeShyb290LmtvKTtcclxuICB9XHJcbn0odGhpcywgZnVuY3Rpb24gKGtvKSB7XHJcbnZhciBhcHBseUtvdixcbiAgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5O1xuXG5hcHBseUtvdiA9IGZ1bmN0aW9uKGtvKSB7XG4gIHZhciBEaXNwb3NhYmxlLCBfaWRDb3VudGVyLCBnZXREZXBlbmRlbmNpZXMsIGdldFVuaXF1ZUlkO1xuICBrby52YWxpZGF0ZWQgPSB7fTtcbiAgRGlzcG9zYWJsZSA9IChmdW5jdGlvbigpIHtcbiAgICBmdW5jdGlvbiBEaXNwb3NhYmxlKG5hbWUxLCBtZXNzYWdlMSwgdGFyZ2V0MSwgZGlzcG9zZSwgaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5uYW1lID0gbmFtZTE7XG4gICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlMTtcbiAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0MTtcbiAgICAgIGlmIChkaXNwb3NlICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlID0gZGlzcG9zZTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0Rpc3Bvc2VkICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gaXNEaXNwb3NlZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7fTtcblxuICAgIERpc3Bvc2FibGUucHJvdG90eXBlLmlzRGlzcG9zZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGlzcG9zYWJsZTtcblxuICB9KSgpO1xuICBfaWRDb3VudGVyID0gMDtcbiAgZ2V0VW5pcXVlSWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKytfaWRDb3VudGVyO1xuICB9O1xuICBrby5leHRlbmRlcnMuZmFsbGlibGUgPSBmdW5jdGlvbih0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICB2YXIgX2Vycm9yRXhpc3RzLCBfZXJyb3JzLCBfaGFzT3duUHJvcCwgX25hbWVkLCBfcmVnaXN0ZXJFcnJvciwgX3JlbW92ZUVycm9yO1xuICAgIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgaWYgKHR5cGVvZiB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbiAgICBpZiAoa28uZXh0ZW5kZXJzLmZhbGxpYmxlLmlzRmFsbGlibGUodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG4gICAgX2Vycm9ycyA9IGtvLm9ic2VydmFibGUoe30pO1xuICAgIF9uYW1lZCA9IHt9O1xuICAgIF9oYXNPd25Qcm9wID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgX3JlbW92ZUVycm9yID0gZnVuY3Rpb24oaWQsIHRyaWdnZXIpIHtcbiAgICAgIHZhciBlcnJvcnMsIG5hbWU7XG4gICAgICBpZiAodHlwZW9mIGlkID09PSAnc3RyaW5nJykge1xuICAgICAgICBpZiAoe30uaGFzT3duUHJvcGVydHkoX25hbWVkLCBpZCkpIHtcbiAgICAgICAgICBuYW1lID0gaWQ7XG4gICAgICAgICAgaWQgPSBfbmFtZWRbaWRdO1xuICAgICAgICAgIGRlbGV0ZSBfbmFtZWRbbmFtZV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWQgPSB2b2lkIDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpZCAhPSBudWxsKSB7XG4gICAgICAgIGVycm9ycyA9IF9lcnJvcnMoKTtcbiAgICAgICAgaWYgKF9oYXNPd25Qcm9wLmNhbGwoZXJyb3JzLCBpZCkpIHtcbiAgICAgICAgICBkZWxldGUgZXJyb3JzW2lkXTtcbiAgICAgICAgICBpZiAodHJpZ2dlciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIF9lcnJvcnMudmFsdWVIYXNNdXRhdGVkKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBfZXJyb3JFeGlzdHMgPSBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIF9oYXNPd25Qcm9wLmNhbGwoX2Vycm9ycygpLCBpZCk7XG4gICAgfTtcbiAgICBfcmVnaXN0ZXJFcnJvciA9IGZ1bmN0aW9uKGVycm9ycywgbWVzc2FnZSwgbmFtZSwgdHJpZ2dlcikge1xuICAgICAgdmFyIGRpc3Bvc2FibGUsIGlkO1xuICAgICAgaWYgKG1lc3NhZ2UgIT0gbnVsbCkge1xuICAgICAgICBpZCA9IGdldFVuaXF1ZUlkKCk7XG4gICAgICAgIGRpc3Bvc2FibGUgPSBuZXcgRGlzcG9zYWJsZShuYW1lLCBtZXNzYWdlLCB0YXJnZXQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBfcmVtb3ZlRXJyb3IobmFtZSAhPSBudWxsID8gbmFtZSA6IGlkKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuICFfZXJyb3JFeGlzdHMoaWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIGlmICh7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKF9uYW1lZCwgbmFtZSkpIHtcbiAgICAgICAgICAgIF9yZW1vdmVFcnJvcihfbmFtZWRbbmFtZV0sIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgX25hbWVkW25hbWVdID0gaWQ7XG4gICAgICAgIH1cbiAgICAgICAgZXJyb3JzW2lkXSA9IG1lc3NhZ2U7XG4gICAgICAgIGlmICh0cmlnZ2VyICE9PSBmYWxzZSkge1xuICAgICAgICAgIF9lcnJvcnMudmFsdWVIYXNNdXRhdGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpc3Bvc2FibGUgPSBuZXcgRGlzcG9zYWJsZShuYW1lLCBtZXNzYWdlLCB0YXJnZXQpO1xuICAgICAgICBfcmVtb3ZlRXJyb3IobmFtZSwgdHJpZ2dlcik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZTtcbiAgICB9O1xuICAgIHRhcmdldC5lcnJvcnMgPSBrby5wdXJlQ29tcHV0ZWQoe1xuICAgICAgcmVhZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb2xsZWN0TWVzc2FnZXMsIGlkLCBtZXNzYWdlLCBtZXNzYWdlcywgcmVmO1xuICAgICAgICBtZXNzYWdlcyA9IFtdO1xuICAgICAgICBjb2xsZWN0TWVzc2FnZXMgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgICAgdmFyIGksIGxlbiwgc3ViTWVzc2FnZTtcbiAgICAgICAgICBpZiAobWVzc2FnZSA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UoKTtcbiAgICAgICAgICAgIGNvbGxlY3RNZXNzYWdlcyhtZXNzYWdlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkobWVzc2FnZSkpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IG1lc3NhZ2UubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgc3ViTWVzc2FnZSA9IG1lc3NhZ2VbaV07XG4gICAgICAgICAgICAgIGNvbGxlY3RNZXNzYWdlcyhzdWJNZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIG1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5hc3NlcnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KGZhbHNlLCAnaW52YWxpZCBlcnJvciBtZXNzYWdlJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJlZiA9IF9lcnJvcnMoKTtcbiAgICAgICAgZm9yIChpZCBpbiByZWYpIHtcbiAgICAgICAgICBpZiAoIWhhc1Byb3AuY2FsbChyZWYsIGlkKSkgY29udGludWU7XG4gICAgICAgICAgbWVzc2FnZSA9IHJlZltpZF07XG4gICAgICAgICAgY29sbGVjdE1lc3NhZ2VzKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZXNzYWdlcztcbiAgICAgIH0sXG4gICAgICB3cml0ZTogZnVuY3Rpb24obWVzc2FnZXMpIHtcbiAgICAgICAgdGFyZ2V0LmVycm9ycy5zZXQobWVzc2FnZXMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRhcmdldC5lcnJvcnMuYWRkID0gZnVuY3Rpb24obmFtZSwgbWVzc2FnZSkge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgbWVzc2FnZSA9IG5hbWU7XG4gICAgICAgIG5hbWUgPSB2b2lkIDA7XG4gICAgICB9XG4gICAgICByZXR1cm4gX3JlZ2lzdGVyRXJyb3IoX2Vycm9ycygpLCBtZXNzYWdlLCBuYW1lLCB0cnVlKTtcbiAgICB9O1xuICAgIHRhcmdldC5lcnJvcnMuc2V0ID0gZnVuY3Rpb24obmFtZSwgbWVzc2FnZSkge1xuICAgICAgdmFyIGRpc3Bvc2FibGUsIGVycm9ycztcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIG1lc3NhZ2UgPSBuYW1lO1xuICAgICAgICBuYW1lID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgZXJyb3JzID0ge307XG4gICAgICBfbmFtZWQgPSB7fTtcbiAgICAgIGRpc3Bvc2FibGUgPSBfcmVnaXN0ZXJFcnJvcihlcnJvcnMsIG1lc3NhZ2UsIG5hbWUsIGZhbHNlKTtcbiAgICAgIF9lcnJvcnMoZXJyb3JzKTtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlO1xuICAgIH07XG4gICAgdGFyZ2V0LmVycm9ycy5nZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICB2YXIgZmluZE1lc3NhZ2UsIGZpcnN0TWVzc2FnZSwgaWQsIG1lc3NhZ2UsIHJlZjtcbiAgICAgIGZpcnN0TWVzc2FnZSA9IHZvaWQgMDtcbiAgICAgIGZpbmRNZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICB2YXIgaSwgbGVuLCBzdWJNZXNzYWdlO1xuICAgICAgICBpZiAobWVzc2FnZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UoKTtcbiAgICAgICAgICBpZiAoZmluZE1lc3NhZ2UobWVzc2FnZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG1lc3NhZ2UpKSB7XG4gICAgICAgICAgZm9yIChpID0gMCwgbGVuID0gbWVzc2FnZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgc3ViTWVzc2FnZSA9IG1lc3NhZ2VbaV07XG4gICAgICAgICAgICBpZiAoZmluZE1lc3NhZ2Uoc3ViTWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBmaXJzdE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuYXNzZXJ0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoZmFsc2UsICdpbnZhbGlkIGVycm9yIG1lc3NhZ2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKHt9Lmhhc093blByb3BlcnR5LmNhbGwoX25hbWVkLCBuYW1lKSkge1xuICAgICAgICAgIGlmIChmaW5kTWVzc2FnZShfZXJyb3JzKClbX25hbWVkW25hbWVdXSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJzdE1lc3NhZ2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWYgPSBfZXJyb3JzKCk7XG4gICAgICAgIGZvciAoaWQgaW4gcmVmKSB7XG4gICAgICAgICAgaWYgKCFoYXNQcm9wLmNhbGwocmVmLCBpZCkpIGNvbnRpbnVlO1xuICAgICAgICAgIG1lc3NhZ2UgPSByZWZbaWRdO1xuICAgICAgICAgIGlmIChmaW5kTWVzc2FnZShtZXNzYWdlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0TWVzc2FnZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3JzLmhhcyA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiB0YXJnZXQuZXJyb3JzLmdldChuYW1lKSAhPSBudWxsO1xuICAgIH07XG4gICAgdGFyZ2V0LmVycm9ycy5yZW1vdmUgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIF9yZW1vdmVFcnJvcihuYW1lKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRhcmdldC5lcnJvcnMuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIF9uYW1lZCA9IHt9O1xuICAgICAgX2Vycm9ycyh7fSk7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3IgPSBrby5wdXJlQ29tcHV0ZWQoe1xuICAgICAgcmVhZDogdGFyZ2V0LmVycm9ycy5nZXQsXG4gICAgICB3cml0ZTogdGFyZ2V0LmVycm9ycy5zZXRcbiAgICB9KTtcbiAgICB0YXJnZXQuaGFzRXJyb3IgPSBrby5wdXJlQ29tcHV0ZWQoe1xuICAgICAgcmVhZDogdGFyZ2V0LmVycm9ycy5oYXNcbiAgICB9KTtcbiAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgX2Vycm9ycyh7fSk7XG4gICAgICBkZWxldGUgdGFyZ2V0LmVycm9yO1xuICAgICAgZGVsZXRlIHRhcmdldC5lcnJvcnM7XG4gICAgICBkZWxldGUgdGFyZ2V0Lmhhc0Vycm9yO1xuICAgICAgZGVsZXRlIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlO1xuICAgIH07XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAga28uZXh0ZW5kZXJzLmZhbGxpYmxlLmlzRmFsbGlibGUgPSBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICByZXR1cm4gKHRhcmdldC5lcnJvcnMgIT0gbnVsbCkgJiYgKHRhcmdldC5lcnJvciAhPSBudWxsKTtcbiAgfTtcbiAgZ2V0RGVwZW5kZW5jaWVzID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBkZXBLZXksIHN5bVN0YXRlO1xuICAgIHN5bVN0YXRlID0gKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGMsIGksIGxlbiwgcmVmLCBzeW1ib2w7XG4gICAgICBjID0ga28uY29tcHV0ZWQoZnVuY3Rpb24oKSB7fSk7XG4gICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAhPSBudWxsKSB7XG4gICAgICAgIHJlZiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoYyk7XG4gICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHN5bWJvbCA9IHJlZltpXTtcbiAgICAgICAgICBpZiAoU3RyaW5nKHN5bWJvbCkgPT09ICdTeW1ib2woX3N0YXRlKScpIHtcbiAgICAgICAgICAgIHJldHVybiBzeW1ib2w7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoe30uaGFzT3duUHJvcGVydHkuY2FsbChjLCAnX3N0YXRlJykpIHtcbiAgICAgICAgcmV0dXJuICdfc3RhdGUnO1xuICAgICAgfVxuICAgIH0pKCk7XG4gICAgZGVwS2V5ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGMsIGtleSwgbywgcmVmLCB2YWw7XG4gICAgICBvID0ga28ub2JzZXJ2YWJsZSgpO1xuICAgICAgYyA9IGtvLmNvbXB1dGVkKHtcbiAgICAgICAgcmVhZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIG8oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZWYgPSBjW3N5bVN0YXRlXTtcbiAgICAgIGZvciAoa2V5IGluIHJlZikge1xuICAgICAgICBpZiAoIWhhc1Byb3AuY2FsbChyZWYsIGtleSkpIGNvbnRpbnVlO1xuICAgICAgICB2YWwgPSByZWZba2V5XTtcbiAgICAgICAgaWYgKCh2YWwgIT0gbnVsbCkgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSkoKTtcbiAgICByZXR1cm4gZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICBpZiAoa28uaXNDb21wdXRlZCh0YXJnZXQpKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXRbc3ltU3RhdGVdW2RlcEtleV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge307XG4gICAgICB9XG4gICAgfTtcbiAgfSkoKTtcbiAga28uZXh0ZW5kZXJzLmZhbGxpYmxlUmVhZCA9IGZ1bmN0aW9uKHRhcmdldCwgb3B0aW9ucykge1xuICAgIHZhciBkaXNwb3NhYmxlLCBlcnJvcnMsIGZpbmRJbm5lcjtcbiAgICBpZiAoIWtvLmlzQ29tcHV0ZWQodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG4gICAgdGFyZ2V0LmV4dGVuZCh7XG4gICAgICBmYWxsaWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgaWYgKHR5cGVvZiB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZVJlYWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZVJlYWQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZmluZElubmVyID0gZnVuY3Rpb24ob3V0cHV0LCBjb21wdXRlZCkge1xuICAgICAgdmFyIGRlcGVuZGVuY3ksIGtleSwgcmVmO1xuICAgICAgcmVmID0gZ2V0RGVwZW5kZW5jaWVzKGNvbXB1dGVkKTtcbiAgICAgIGZvciAoa2V5IGluIHJlZikge1xuICAgICAgICBpZiAoIWhhc1Byb3AuY2FsbChyZWYsIGtleSkpIGNvbnRpbnVlO1xuICAgICAgICBkZXBlbmRlbmN5ID0gcmVmW2tleV07XG4gICAgICAgIGRlcGVuZGVuY3kgPSBkZXBlbmRlbmN5Ll90YXJnZXQ7XG4gICAgICAgIGlmIChrby5leHRlbmRlcnMuZmFsbGlibGUuaXNGYWxsaWJsZShkZXBlbmRlbmN5KSkge1xuICAgICAgICAgIGlmIChvdXRwdXQuaW5kZXhPZihkZXBlbmRlbmN5LmVycm9ycykgPT09IC0xKSB7XG4gICAgICAgICAgICBvdXRwdXQucHVzaChkZXBlbmRlbmN5LmVycm9ycyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChrby5pc0NvbXB1dGVkKGRlcGVuZGVuY3kpKSB7XG4gICAgICAgICAgZmluZElubmVyKG91dHB1dCwgZGVwZW5kZW5jeSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICBlcnJvcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmaW5kSW5uZXIoW10sIHRhcmdldCk7XG4gICAgICB9IGZpbmFsbHkge1xuXG4gICAgICB9XG4gICAgfTtcbiAgICBkaXNwb3NhYmxlID0gdGFyZ2V0LmVycm9ycy5hZGQoZXJyb3JzKTtcbiAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZVJlYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChkaXNwb3NhYmxlICE9IG51bGwpIHtcbiAgICAgICAgZGlzcG9zYWJsZS5kaXNwb3NlKCk7XG4gICAgICAgIGRpc3Bvc2FibGUgPSB2b2lkIDA7XG4gICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICByZXR1cm4ga287XG59O1xuXG5hcHBseUtvdihrbyk7XG5cclxucmV0dXJuIGtvO1xyXG59KSk7XHJcbiIsImFwcGx5S292ID0gKGtvKSAtPlxyXG4gIGtvLnZhbGlkYXRlZCA9IHt9XHJcblxyXG5cclxuICBjbGFzcyBEaXNwb3NhYmxlXHJcbiAgICBjb25zdHJ1Y3RvcjogKEBuYW1lLCBAbWVzc2FnZSwgQHRhcmdldCwgZGlzcG9zZSwgaXNEaXNwb3NlZCkgLT5cclxuICAgICAgaWYgZGlzcG9zZT9cclxuICAgICAgICBAZGlzcG9zZSA9IGRpc3Bvc2VcclxuICAgICAgaWYgaXNEaXNwb3NlZD9cclxuICAgICAgICBAaXNEaXNwb3NlZCA9IGlzRGlzcG9zZWRcclxuXHJcbiAgICBkaXNwb3NlOiAoKSAtPlxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICBpc0Rpc3Bvc2VkOiAoKSAtPlxyXG4gICAgICByZXR1cm4gdHJ1ZVxyXG5cclxuICBfaWRDb3VudGVyID0gMFxyXG4gIGdldFVuaXF1ZUlkID0gKCkgLT5cclxuICAgICsrX2lkQ291bnRlclxyXG5cclxuICBrby5leHRlbmRlcnMuZmFsbGlibGUgPSAodGFyZ2V0LCBvcHRpb25zKSAtPlxyXG4gICAgIyBEaXNwb3NlP1xyXG4gICAgaWYgb3B0aW9ucyA9PSBmYWxzZVxyXG4gICAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZT8oKVxyXG4gICAgICByZXR1cm4gdGFyZ2V0XHJcblxyXG4gICAgIyBBbHJlYWR5IGNvbnN0cnVjdGVkXHJcbiAgICBpZiBrby5leHRlbmRlcnMuZmFsbGlibGUuaXNGYWxsaWJsZSh0YXJnZXQpXHJcbiAgICAgIHJldHVybiB0YXJnZXRcclxuXHJcbiAgICAjIGNvbnRhaW5zIHRoZSBlcnJvcnMgZm9yIHRhcmdldFxyXG4gICAgX2Vycm9ycyA9IGtvLm9ic2VydmFibGUoe30pXHJcbiAgICBfbmFtZWQgPSB7fVxyXG5cclxuICAgICMgaGVscGVyIGZvciBjYWxsaW5nIGhhc093blByb3BlcnR5XHJcbiAgICBfaGFzT3duUHJvcCA9ICh7fSkuaGFzT3duUHJvcGVydHlcclxuXHJcbiAgICAjIFJlbW92ZXMgdGhlIHNwZWNpZmllZCBlcnJvciwgaWYgaXQgZXhpc3RzXHJcbiAgICBfcmVtb3ZlRXJyb3IgPSAoaWQsIHRyaWdnZXIpIC0+XHJcbiAgICAgIGlmIHR5cGVvZiBpZCA9PSAnc3RyaW5nJ1xyXG4gICAgICAgIGlmIHt9Lmhhc093blByb3BlcnR5KF9uYW1lZCwgaWQpXHJcbiAgICAgICAgICBuYW1lID0gaWRcclxuICAgICAgICAgIGlkID0gX25hbWVkW2lkXVxyXG4gICAgICAgICAgZGVsZXRlIF9uYW1lZFtuYW1lXVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgIGlkID0gdW5kZWZpbmVkXHJcblxyXG4gICAgICBpZiBpZD9cclxuICAgICAgICBlcnJvcnMgPSBfZXJyb3JzKClcclxuXHJcbiAgICAgICAgaWYgX2hhc093blByb3AuY2FsbChlcnJvcnMsIGlkKVxyXG4gICAgICAgICAgZGVsZXRlIGVycm9yc1tpZF1cclxuXHJcbiAgICAgICAgICBpZiB0cmlnZ2VyICE9IGZhbHNlXHJcbiAgICAgICAgICAgIF9lcnJvcnMudmFsdWVIYXNNdXRhdGVkKClcclxuXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgICMgUmV0dXJucyB0cnVlIGlmZiB0aGUgc3BlY2lmaWVkIGVycm9yIGV4aXN0c1xyXG4gICAgX2Vycm9yRXhpc3RzID0gKGlkKSAtPlxyXG4gICAgICBfaGFzT3duUHJvcC5jYWxsKF9lcnJvcnMoKSwgaWQpXHJcblxyXG4gICAgX3JlZ2lzdGVyRXJyb3IgPSAoZXJyb3JzLCBtZXNzYWdlLCBuYW1lLCB0cmlnZ2VyKSAtPlxyXG4gICAgICBpZiBtZXNzYWdlP1xyXG4gICAgICAgIGlkID0gZ2V0VW5pcXVlSWQoKVxyXG5cclxuICAgICAgICBkaXNwb3NhYmxlID0gbmV3IERpc3Bvc2FibGUoXHJcbiAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgbWVzc2FnZVxyXG4gICAgICAgICAgdGFyZ2V0XHJcbiAgICAgICAgICAoKSAtPiBfcmVtb3ZlRXJyb3IobmFtZSA/IGlkKVxyXG4gICAgICAgICAgKCkgLT4gbm90IF9lcnJvckV4aXN0cyhpZClcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGlmIHR5cGVvZiBuYW1lID09ICdzdHJpbmcnXHJcbiAgICAgICAgICBpZiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKF9uYW1lZCwgbmFtZSlcclxuICAgICAgICAgICAgX3JlbW92ZUVycm9yKF9uYW1lZFtuYW1lXSwgZmFsc2UpXHJcblxyXG4gICAgICAgICAgX25hbWVkW25hbWVdID0gaWRcclxuXHJcbiAgICAgICAgZXJyb3JzW2lkXSA9IG1lc3NhZ2VcclxuXHJcbiAgICAgICAgaWYgdHJpZ2dlciAhPSBmYWxzZVxyXG4gICAgICAgICAgX2Vycm9ycy52YWx1ZUhhc011dGF0ZWQoKVxyXG4gICAgICBlbHNlXHJcbiAgICAgICAgZGlzcG9zYWJsZSA9IG5ldyBEaXNwb3NhYmxlKFxyXG4gICAgICAgICAgbmFtZSxcclxuICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICB0YXJnZXRcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIF9yZW1vdmVFcnJvcihuYW1lLCB0cmlnZ2VyKVxyXG5cclxuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVcclxuXHJcbiAgICAjIEEgbGlzdCBvZiBhbGwgZXJyb3JzXHJcbiAgICB0YXJnZXQuZXJyb3JzID0ga28ucHVyZUNvbXB1dGVkKHtcclxuICAgICAgcmVhZDogKCkgLT5cclxuICAgICAgICBtZXNzYWdlcyA9IFtdXHJcblxyXG4gICAgICAgIGNvbGxlY3RNZXNzYWdlcyA9IChtZXNzYWdlKSAtPlxyXG4gICAgICAgICAgaWYgbm90IG1lc3NhZ2U/XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgZWxzZSBpZiB0eXBlb2YgbWVzc2FnZSA9PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlKClcclxuICAgICAgICAgICAgY29sbGVjdE1lc3NhZ2VzKG1lc3NhZ2UpXHJcbiAgICAgICAgICBlbHNlIGlmIEFycmF5LmlzQXJyYXkobWVzc2FnZSlcclxuICAgICAgICAgICAgZm9yIHN1Yk1lc3NhZ2UgaW4gbWVzc2FnZVxyXG4gICAgICAgICAgICAgIGNvbGxlY3RNZXNzYWdlcyhzdWJNZXNzYWdlKVxyXG4gICAgICAgICAgZWxzZSBpZiB0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJyBvciB0eXBlb2YgbWVzc2FnZSA9PSAnb2JqZWN0J1xyXG4gICAgICAgICAgICBtZXNzYWdlcy5wdXNoKG1lc3NhZ2UpXHJcbiAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGNvbnNvbGU/LmFzc2VydD8oZmFsc2UsICdpbnZhbGlkIGVycm9yIG1lc3NhZ2UnKVxyXG5cclxuICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBmb3Igb3duIGlkLCBtZXNzYWdlIG9mIF9lcnJvcnMoKVxyXG4gICAgICAgICAgY29sbGVjdE1lc3NhZ2VzKG1lc3NhZ2UpXHJcblxyXG4gICAgICAgIHJldHVybiBtZXNzYWdlc1xyXG5cclxuICAgICAgd3JpdGU6IChtZXNzYWdlcykgLT5cclxuICAgICAgICB0YXJnZXQuZXJyb3JzLnNldChtZXNzYWdlcylcclxuICAgICAgICByZXR1cm5cclxuICAgIH0pXHJcblxyXG4gICAgIyBBZGQgYW4gaW5kaXZpZHVhbCBlcnJvclxyXG4gICAgdGFyZ2V0LmVycm9ycy5hZGQgPSAobmFtZSwgbWVzc2FnZSkgLT5cclxuICAgICAgaWYgYXJndW1lbnRzLmxlbmd0aCA9PSAxXHJcbiAgICAgICAgbWVzc2FnZSA9IG5hbWVcclxuICAgICAgICBuYW1lID0gdW5kZWZpbmVkXHJcblxyXG4gICAgICByZXR1cm4gX3JlZ2lzdGVyRXJyb3IoX2Vycm9ycygpLCBtZXNzYWdlLCBuYW1lLCB0cnVlKVxyXG5cclxuICAgICMgU2V0IGEgc2luZ2xlIGVycm9yLCBjbGVhcmluZyBvdGhlciBlcnJvcnNcclxuICAgIHRhcmdldC5lcnJvcnMuc2V0ID0gKG5hbWUsIG1lc3NhZ2UpIC0+XHJcbiAgICAgIGlmIGFyZ3VtZW50cy5sZW5ndGggPT0gMVxyXG4gICAgICAgIG1lc3NhZ2UgPSBuYW1lXHJcbiAgICAgICAgbmFtZSA9IHVuZGVmaW5lZFxyXG5cclxuICAgICAgZXJyb3JzID0ge31cclxuICAgICAgX25hbWVkID0ge31cclxuICAgICAgZGlzcG9zYWJsZSA9IF9yZWdpc3RlckVycm9yKGVycm9ycywgbWVzc2FnZSwgbmFtZSwgZmFsc2UpXHJcbiAgICAgIF9lcnJvcnMoZXJyb3JzKVxyXG4gICAgICByZXR1cm4gZGlzcG9zYWJsZVxyXG5cclxuICAgICMgR2V0IHRoZSBmaXJzdCBlcnJvclxyXG4gICAgdGFyZ2V0LmVycm9ycy5nZXQgPSAobmFtZSkgLT5cclxuICAgICAgZmlyc3RNZXNzYWdlID0gdW5kZWZpbmVkXHJcblxyXG4gICAgICBmaW5kTWVzc2FnZSA9IChtZXNzYWdlKSAtPlxyXG4gICAgICAgIGlmIG5vdCBtZXNzYWdlP1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgZWxzZSBpZiB0eXBlb2YgbWVzc2FnZSA9PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSgpXHJcbiAgICAgICAgICBpZiBmaW5kTWVzc2FnZShtZXNzYWdlKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIGVsc2UgaWYgQXJyYXkuaXNBcnJheShtZXNzYWdlKVxyXG4gICAgICAgICAgZm9yIHN1Yk1lc3NhZ2UgaW4gbWVzc2FnZVxyXG4gICAgICAgICAgICBpZiBmaW5kTWVzc2FnZShzdWJNZXNzYWdlKVxyXG4gICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgZWxzZSBpZiB0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJyBvciB0eXBlb2YgbWVzc2FnZSA9PSAnb2JqZWN0J1xyXG4gICAgICAgICAgZmlyc3RNZXNzYWdlID0gbWVzc2FnZVxyXG4gICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICBjb25zb2xlPy5hc3NlcnQ/KGZhbHNlLCAnaW52YWxpZCBlcnJvciBtZXNzYWdlJylcclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcblxyXG4gICAgICBpZiB0eXBlb2YgbmFtZSA9PSAnc3RyaW5nJ1xyXG4gICAgICAgIGlmIHt9Lmhhc093blByb3BlcnR5LmNhbGwoX25hbWVkLCBuYW1lKVxyXG4gICAgICAgICAgaWYgZmluZE1lc3NhZ2UoX2Vycm9ycygpW19uYW1lZFtuYW1lXV0pXHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdE1lc3NhZ2VcclxuICAgICAgZWxzZVxyXG4gICAgICAgIGZvciBvd24gaWQsIG1lc3NhZ2Ugb2YgX2Vycm9ycygpXHJcbiAgICAgICAgICBpZiBmaW5kTWVzc2FnZShtZXNzYWdlKVxyXG4gICAgICAgICAgICByZXR1cm4gZmlyc3RNZXNzYWdlXHJcblxyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkXHJcblxyXG4gICAgdGFyZ2V0LmVycm9ycy5oYXMgPSAobmFtZSkgLT5cclxuICAgICAgcmV0dXJuIHRhcmdldC5lcnJvcnMuZ2V0KG5hbWUpP1xyXG5cclxuICAgIHRhcmdldC5lcnJvcnMucmVtb3ZlID0gKG5hbWUpIC0+XHJcbiAgICAgIGlmIHR5cGVvZiBuYW1lID09ICdzdHJpbmcnXHJcbiAgICAgICAgX3JlbW92ZUVycm9yKG5hbWUpXHJcblxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICAjIENsZWFyIGFsbCB0aGUgY3VycmVudCBlcnJvcnNcclxuICAgIHRhcmdldC5lcnJvcnMuY2xlYXIgPSAoKSAtPlxyXG4gICAgICBfbmFtZWQgPSB7fVxyXG4gICAgICBfZXJyb3JzKHt9KVxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICAjIEdldCB0aGUgZmlyc3QgZXJyb3IsIG9yIFNldCBhIHNpbmdsZSBlcnJvciB3aGlsc3QgY2xlYXJpbmcgb3RoZXIgZXJyb3JzXHJcbiAgICB0YXJnZXQuZXJyb3IgPSBrby5wdXJlQ29tcHV0ZWQoe1xyXG4gICAgICByZWFkOiB0YXJnZXQuZXJyb3JzLmdldFxyXG4gICAgICB3cml0ZTogdGFyZ2V0LmVycm9ycy5zZXRcclxuICAgIH0pXHJcblxyXG4gICAgIyBSZXR1cm4gdHJ1ZSBpZmYgdGhlcmUgYXJlIGFueSBlcnJvcnNcclxuICAgIHRhcmdldC5oYXNFcnJvciA9IGtvLnB1cmVDb21wdXRlZCh7XHJcbiAgICAgIHJlYWQ6IHRhcmdldC5lcnJvcnMuaGFzXHJcbiAgICB9KVxyXG5cclxuICAgICMgUmVtb3ZlIGZhbGxpYmxlIGRhdGEgZnJvbSB0aGUgdGFyZ2V0IG9iamVjdFxyXG4gICAgdGFyZ2V0Ll9kaXNwb3NlRmFsbGlibGUgPSAoKSAtPlxyXG4gICAgICBfZXJyb3JzKHt9KVxyXG4gICAgICBkZWxldGUgdGFyZ2V0LmVycm9yXHJcbiAgICAgIGRlbGV0ZSB0YXJnZXQuZXJyb3JzXHJcbiAgICAgIGRlbGV0ZSB0YXJnZXQuaGFzRXJyb3JcclxuICAgICAgZGVsZXRlIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIHJldHVybiB0YXJnZXRcclxuXHJcbiAgIyBEZXRlcm1pbmUgaWYgaXRlbSBpcyBmYWxsaWJsZVxyXG4gIGtvLmV4dGVuZGVycy5mYWxsaWJsZS5pc0ZhbGxpYmxlID0gKHRhcmdldCkgLT5cclxuICAgIHJldHVybiB0YXJnZXQuZXJyb3JzPyBhbmQgdGFyZ2V0LmVycm9yP1xyXG5cclxuICBnZXREZXBlbmRlbmNpZXMgPSBkbyAtPlxyXG4gICAgc3ltU3RhdGUgPSBkbyAtPlxyXG4gICAgICBjID0ga28uY29tcHV0ZWQoKCkgLT4gcmV0dXJuKVxyXG4gICAgICBpZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzP1xyXG4gICAgICAgIGZvciBzeW1ib2wgaW4gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhjKVxyXG4gICAgICAgICAgaWYgU3RyaW5nKHN5bWJvbCkgPT0gJ1N5bWJvbChfc3RhdGUpJ1xyXG4gICAgICAgICAgICByZXR1cm4gc3ltYm9sXHJcblxyXG4gICAgICBpZiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGMsICdfc3RhdGUnKVxyXG4gICAgICAgIHJldHVybiAnX3N0YXRlJ1xyXG5cclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgZGVwS2V5ID0gZG8gLT5cclxuICAgICAgbyA9IGtvLm9ic2VydmFibGUoKVxyXG4gICAgICBjID0ga28uY29tcHV0ZWQoe1xyXG4gICAgICAgIHJlYWQ6ICgpIC0+IG8oKVxyXG4gICAgICB9KVxyXG4gICAgICBmb3Igb3duIGtleSwgdmFsIG9mIGNbc3ltU3RhdGVdXHJcbiAgICAgICAgaWYgdmFsPyBhbmQgdHlwZW9mIHZhbCA9PSAnb2JqZWN0J1xyXG4gICAgICAgICAgcmV0dXJuIGtleVxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICByZXR1cm4gKHRhcmdldCkgLT5cclxuICAgICAgaWYga28uaXNDb21wdXRlZCh0YXJnZXQpXHJcbiAgICAgICAgcmV0dXJuIHRhcmdldFtzeW1TdGF0ZV1bZGVwS2V5XVxyXG4gICAgICBlbHNlXHJcbiAgICAgICAgcmV0dXJuIHt9XHJcblxyXG4gIGtvLmV4dGVuZGVycy5mYWxsaWJsZVJlYWQgPSAodGFyZ2V0LCBvcHRpb25zKSAtPlxyXG4gICAgaWYgbm90IGtvLmlzQ29tcHV0ZWQodGFyZ2V0KVxyXG4gICAgICByZXR1cm4gdGFyZ2V0XHJcblxyXG4gICAgdGFyZ2V0LmV4dGVuZCh7IGZhbGxpYmxlOiB0cnVlIH0pXHJcblxyXG4gICAgaWYgb3B0aW9ucyA9PSBmYWxzZVxyXG4gICAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZVJlYWQ/KClcclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgZmluZElubmVyID0gKG91dHB1dCwgY29tcHV0ZWQpIC0+XHJcbiAgICAgIGZvciBvd24ga2V5LCBkZXBlbmRlbmN5IG9mIGdldERlcGVuZGVuY2llcyhjb21wdXRlZClcclxuICAgICAgICBkZXBlbmRlbmN5ID0gZGVwZW5kZW5jeS5fdGFyZ2V0XHJcbiAgICAgICAgaWYga28uZXh0ZW5kZXJzLmZhbGxpYmxlLmlzRmFsbGlibGUoZGVwZW5kZW5jeSlcclxuICAgICAgICAgIGlmIG91dHB1dC5pbmRleE9mKGRlcGVuZGVuY3kuZXJyb3JzKSA9PSAtMVxyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChkZXBlbmRlbmN5LmVycm9ycylcclxuXHJcbiAgICAgICAgaWYga28uaXNDb21wdXRlZChkZXBlbmRlbmN5KVxyXG4gICAgICAgICAgZmluZElubmVyKG91dHB1dCwgZGVwZW5kZW5jeSlcclxuXHJcbiAgICAgIHJldHVybiBvdXRwdXRcclxuXHJcbiAgICBlcnJvcnMgPSAoKSAtPlxyXG4gICAgICB0cnlcclxuICAgICAgICAjc3Vic2NyaXB0aW9uID0gdGFyZ2V0LnN1YnNjcmliZSgoKSAtPiByZXR1cm4pXHJcbiAgICAgICAgI3RhcmdldCgpXHJcbiAgICAgICAgcmV0dXJuIGZpbmRJbm5lcihbXSwgdGFyZ2V0KVxyXG4gICAgICBmaW5hbGx5XHJcbiAgICAgICAgI3N1YnNjcmlwdGlvbi5kaXNwb3NlKClcclxuXHJcbiAgICBkaXNwb3NhYmxlID0gdGFyZ2V0LmVycm9ycy5hZGQoZXJyb3JzKVxyXG5cclxuICAgIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlUmVhZCA9ICgpIC0+XHJcbiAgICAgIGlmIGRpc3Bvc2FibGU/XHJcbiAgICAgICAgZGlzcG9zYWJsZS5kaXNwb3NlKClcclxuICAgICAgICBkaXNwb3NhYmxlID0gdW5kZWZpbmVkXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgIHJldHVybiB0YXJnZXRcclxuXHJcblxyXG4gIHJldHVybiBrb1xyXG5cclxuYXBwbHlLb3Yoa28pXHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
