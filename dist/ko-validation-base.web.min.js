!function(e,r){"function"==typeof define&&define.amd?define([],r):e.applyKov=r()}(this,function(){var e,r={}.hasOwnProperty;return e=function(e){return e.extenders.fallible=function(n,o){var t,s,i,l,u,f;return o===!1?("function"==typeof n._disposeFallible&&n._disposeFallible(),n):e.extenders.fallible.isFallible(n)?n:(i=e.observable({}),u=0,l={}.hasOwnProperty,f=function(e){var r;r=i(),l.call(r,e)&&(delete r[e],i.valueHasMutated())},t=function(e){return l.call(i(),e)},s=function(e,r,o){var s;return null!=r?(s={message:o,target:n,dispose:function(){return f(r)},isDisposed:function(){return!t(r)}},e[r]=o):s={message:o,target:n,dispose:function(){},isDisposed:function(){return!0}},s},n.errors=e.pureComputed({read:function(){var e,n,o,t,s;t=[],e=function(r){var n,o,s;if(null!=r)if("function"==typeof r)r=r(),e(r);else if(Array.isArray(r))for(n=0,o=r.length;o>n;n++)s=r[n],e(s);else"string"==typeof r||"object"==typeof r?t.push(r):"undefined"!=typeof console&&null!==console&&"function"==typeof console.assert&&console.assert(!1,"invalid error message")},s=i();for(n in s)r.call(s,n)&&(o=s[n],e(o));return t},write:function(e){n.errors.set(e)}}),n.errors.add=function(e){var r,n;return null!=e&&(r=++u),n=s(i(),r,e),i.valueHasMutated(),n},n.errors.get=function(){var e,n,o,t,s;n=void 0,e=function(r){var o,t,s;if(null==r)return!1;if("function"==typeof r){if(r=r(),e(r))return!0}else if(Array.isArray(r)){for(o=0,t=r.length;t>o;o++)if(s=r[o],e(s))return!0}else{if("string"==typeof r||"object"==typeof r)return n=r,!0;"undefined"!=typeof console&&null!==console&&"function"==typeof console.assert&&console.assert(!1,"invalid error message")}return!1},s=i();for(o in s)if(r.call(s,o)&&(t=s[o],e(t)))return n},n.errors.set=function(e){var r,n,o;return null!=e&&(n=++u),r={},o=s(r,n,e),i(r),o},n.errors.has=function(){return null!=n.error()},n.errors.clear=function(){i({})},n.error=e.pureComputed({read:n.errors.get,write:n.errors.set}),n.hasError=e.pureComputed({read:n.errors.has}),n._disposeFallible=function(){i({}),delete n.error,delete n.errors,delete n.hasError,delete n._disposeFallible},n)},e.extenders.fallible.isFallible=function(e){return null!=e.errors&&null!=e.error},e.pureErrors=function(r,n){var o,t;return t=void 0,o=e.pureComputed(function(){var e,s,i;i=[],e=function(e,r){null!=e?(e=e.extend({fallible:!0}),i.push(e.errors.add(r))):i.push({message:r,dispose:function(){},isDisposed:function(){return!0}})},s=function(){var e,r,n;for(r=0,n=i.length;n>r;r++)e=i[r],e.dispose();i=[],t.dispose(),t=void 0};try{r.call(n,e)}finally{t=o.subscribe(s,null,"asleep")}return i})},e}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImtvLXZhbGlkYXRpb24tYmFzZS53ZWIuanMiLCJrby12YWxpZGF0aW9uLWJhc2UuY29mZmVlIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiYXBwbHlLb3YiLCJ0aGlzIiwiaGFzUHJvcCIsImhhc093blByb3BlcnR5Iiwia28iLCJleHRlbmRlcnMiLCJmYWxsaWJsZSIsInRhcmdldCIsIm9wdGlvbnMiLCJfZXJyb3JFeGlzdHMiLCJfZXJyb3JNZXRhRGF0YSIsIl9lcnJvcnMiLCJfaGFzT3duUHJvcCIsIl9pZENvdW50ZXIiLCJfcmVtb3ZlRXJyb3IiLCJfZGlzcG9zZUZhbGxpYmxlIiwiaXNGYWxsaWJsZSIsIm9ic2VydmFibGUiLCJpZCIsImVycm9ycyIsImNhbGwiLCJ2YWx1ZUhhc011dGF0ZWQiLCJtZXNzYWdlIiwibWV0YURhdGEiLCJkaXNwb3NlIiwiaXNEaXNwb3NlZCIsInB1cmVDb21wdXRlZCIsInJlYWQiLCJhZGRNZXNzYWdlIiwibWVzc2FnZXMiLCJyZWYiLCJpIiwibGVuIiwic3ViTWVzc2FnZSIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInB1c2giLCJjb25zb2xlIiwiYXNzZXJ0Iiwid3JpdGUiLCJzZXQiLCJhZGQiLCJnZXQiLCJmaW5kTWVzc2FnZSIsImZpcnN0TWVzc2FnZSIsImhhcyIsImVycm9yIiwiY2xlYXIiLCJoYXNFcnJvciIsInB1cmVFcnJvcnMiLCJvd25lciIsImNvbXB1dGVkIiwic3Vic2NyaXB0aW9uIiwiYWRkRXJyb3IiLCJleHRlbmQiLCJzdWJzY3JpYmUiXSwibWFwcGluZ3MiOiJDQUFFLFNBQVNBLEVBQU1DLEdBQ08sa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUN6Q0QsVUFBV0QsR0FFWEQsRUFBS0ksU0FBV0gsS0FFbEJJLEtBQU0sV0FDUixHQUFJRCxHQ1BKRSxLQUFBQyxjRHlPQSxPQ3pPQUgsR0FBVyxTQUFDSSxHQThNVixNQTdNQUEsR0FBR0MsVUFBVUMsU0FBVyxTQUFD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RUFBQUQsRUFBQUEsSUR5QkFnQixFQUFRNUIsRUFBT1ksR0N4QmJnQixFQUFNdkIsU0FDUkwsTUFDQWtDLEVBQWE3QixVQUNiNkIsRUFBZSxPQUdqQixLQUNFMUIsRUFBS1AsS0FBSytCLEVBQU9HLEdBRG5CLFFBR0VELEVBQWVELEVBQVNJLFVBQVVoQyxFQUFTLEtBQU0sVUFFbkQsTUFBT0wsTUFLTmYiLCJmaWxlIjoia28tdmFsaWRhdGlvbi1iYXNlLndlYi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyI7KGZ1bmN0aW9uKHJvb3QsIGZhY3RvcnkpIHtcclxuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XHJcbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByb290LmFwcGx5S292ID0gZmFjdG9yeSgpO1xyXG4gIH1cclxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XHJcbnZhciBhcHBseUtvdixcbiAgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5O1xuXG5hcHBseUtvdiA9IGZ1bmN0aW9uKGtvKSB7XG4gIGtvLmV4dGVuZGVycy5mYWxsaWJsZSA9IGZ1bmN0aW9uKHRhcmdldCwgb3B0aW9ucykge1xuICAgIHZhciBfZXJyb3JFeGlzdHMsIF9lcnJvck1ldGFEYXRhLCBfZXJyb3JzLCBfaGFzT3duUHJvcCwgX2lkQ291bnRlciwgX3JlbW92ZUVycm9yO1xuICAgIGlmIChvcHRpb25zID09PSBmYWxzZSkge1xuICAgICAgaWYgKHR5cGVvZiB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbiAgICBpZiAoa28uZXh0ZW5kZXJzLmZhbGxpYmxlLmlzRmFsbGlibGUodGFyZ2V0KSkge1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG4gICAgX2Vycm9ycyA9IGtvLm9ic2VydmFibGUoe30pO1xuICAgIF9pZENvdW50ZXIgPSAwO1xuICAgIF9oYXNPd25Qcm9wID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgX3JlbW92ZUVycm9yID0gZnVuY3Rpb24oaWQpIHtcbiAgICAgIHZhciBlcnJvcnM7XG4gICAgICBlcnJvcnMgPSBfZXJyb3JzKCk7XG4gICAgICBpZiAoX2hhc093blByb3AuY2FsbChlcnJvcnMsIGlkKSkge1xuICAgICAgICBkZWxldGUgZXJyb3JzW2lkXTtcbiAgICAgICAgX2Vycm9ycy52YWx1ZUhhc011dGF0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIF9lcnJvckV4aXN0cyA9IGZ1bmN0aW9uKGlkKSB7XG4gICAgICByZXR1cm4gX2hhc093blByb3AuY2FsbChfZXJyb3JzKCksIGlkKTtcbiAgICB9O1xuICAgIF9lcnJvck1ldGFEYXRhID0gZnVuY3Rpb24oZXJyb3JzLCBpZCwgbWVzc2FnZSkge1xuICAgICAgdmFyIG1ldGFEYXRhO1xuICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgbWV0YURhdGEgPSB7XG4gICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBfcmVtb3ZlRXJyb3IoaWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNEaXNwb3NlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gIV9lcnJvckV4aXN0cyhpZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBlcnJvcnNbaWRdID0gbWVzc2FnZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1ldGFEYXRhID0ge1xuICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG4gICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgaXNEaXNwb3NlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gbWV0YURhdGE7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3JzID0ga28ucHVyZUNvbXB1dGVkKHtcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYWRkTWVzc2FnZSwgaWQsIG1lc3NhZ2UsIG1lc3NhZ2VzLCByZWY7XG4gICAgICAgIG1lc3NhZ2VzID0gW107XG4gICAgICAgIGFkZE1lc3NhZ2UgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgICAgdmFyIGksIGxlbiwgc3ViTWVzc2FnZTtcbiAgICAgICAgICBpZiAobWVzc2FnZSA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UoKTtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBtZXNzYWdlLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgIHN1Yk1lc3NhZ2UgPSBtZXNzYWdlW2ldO1xuICAgICAgICAgICAgICBhZGRNZXNzYWdlKHN1Yk1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBtZXNzYWdlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgbWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSBcInVuZGVmaW5lZFwiICYmIGNvbnNvbGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLmFzc2VydCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoZmFsc2UsICdpbnZhbGlkIGVycm9yIG1lc3NhZ2UnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmVmID0gX2Vycm9ycygpO1xuICAgICAgICBmb3IgKGlkIGluIHJlZikge1xuICAgICAgICAgIGlmICghaGFzUHJvcC5jYWxsKHJlZiwgaWQpKSBjb250aW51ZTtcbiAgICAgICAgICBtZXNzYWdlID0gcmVmW2lkXTtcbiAgICAgICAgICBhZGRNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtZXNzYWdlcztcbiAgICAgIH0sXG4gICAgICB3cml0ZTogZnVuY3Rpb24obWVzc2FnZXMpIHtcbiAgICAgICAgdGFyZ2V0LmVycm9ycy5zZXQobWVzc2FnZXMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRhcmdldC5lcnJvcnMuYWRkID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgdmFyIGlkLCBtZXRhRGF0YTtcbiAgICAgIGlmIChtZXNzYWdlICE9IG51bGwpIHtcbiAgICAgICAgaWQgPSArK19pZENvdW50ZXI7XG4gICAgICB9XG4gICAgICBtZXRhRGF0YSA9IF9lcnJvck1ldGFEYXRhKF9lcnJvcnMoKSwgaWQsIG1lc3NhZ2UpO1xuICAgICAgX2Vycm9ycy52YWx1ZUhhc011dGF0ZWQoKTtcbiAgICAgIHJldHVybiBtZXRhRGF0YTtcbiAgICB9O1xuICAgIHRhcmdldC5lcnJvcnMuZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZmluZE1lc3NhZ2UsIGZpcnN0TWVzc2FnZSwgaWQsIG1lc3NhZ2UsIHJlZjtcbiAgICAgIGZpcnN0TWVzc2FnZSA9IHZvaWQgMDtcbiAgICAgIGZpbmRNZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICB2YXIgaSwgbGVuLCBzdWJNZXNzYWdlO1xuICAgICAgICBpZiAobWVzc2FnZSA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UoKTtcbiAgICAgICAgICBpZiAoZmluZE1lc3NhZ2UobWVzc2FnZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KG1lc3NhZ2UpKSB7XG4gICAgICAgICAgZm9yIChpID0gMCwgbGVuID0gbWVzc2FnZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgc3ViTWVzc2FnZSA9IG1lc3NhZ2VbaV07XG4gICAgICAgICAgICBpZiAoZmluZE1lc3NhZ2Uoc3ViTWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgbWVzc2FnZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBmaXJzdE1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuYXNzZXJ0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5hc3NlcnQoZmFsc2UsICdpbnZhbGlkIGVycm9yIG1lc3NhZ2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIHJlZiA9IF9lcnJvcnMoKTtcbiAgICAgIGZvciAoaWQgaW4gcmVmKSB7XG4gICAgICAgIGlmICghaGFzUHJvcC5jYWxsKHJlZiwgaWQpKSBjb250aW51ZTtcbiAgICAgICAgbWVzc2FnZSA9IHJlZltpZF07XG4gICAgICAgIGlmIChmaW5kTWVzc2FnZShtZXNzYWdlKSkge1xuICAgICAgICAgIHJldHVybiBmaXJzdE1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3JzLnNldCA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgIHZhciBlcnJvcnMsIGlkLCBtZXRhRGF0YTtcbiAgICAgIGlmIChtZXNzYWdlICE9IG51bGwpIHtcbiAgICAgICAgaWQgPSArK19pZENvdW50ZXI7XG4gICAgICB9XG4gICAgICBlcnJvcnMgPSB7fTtcbiAgICAgIG1ldGFEYXRhID0gX2Vycm9yTWV0YURhdGEoZXJyb3JzLCBpZCwgbWVzc2FnZSk7XG4gICAgICBfZXJyb3JzKGVycm9ycyk7XG4gICAgICByZXR1cm4gbWV0YURhdGE7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3JzLmhhcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRhcmdldC5lcnJvcigpICE9IG51bGw7XG4gICAgfTtcbiAgICB0YXJnZXQuZXJyb3JzLmNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgICBfZXJyb3JzKHt9KTtcbiAgICB9O1xuICAgIHRhcmdldC5lcnJvciA9IGtvLnB1cmVDb21wdXRlZCh7XG4gICAgICByZWFkOiB0YXJnZXQuZXJyb3JzLmdldCxcbiAgICAgIHdyaXRlOiB0YXJnZXQuZXJyb3JzLnNldFxuICAgIH0pO1xuICAgIHRhcmdldC5oYXNFcnJvciA9IGtvLnB1cmVDb21wdXRlZCh7XG4gICAgICByZWFkOiB0YXJnZXQuZXJyb3JzLmhhc1xuICAgIH0pO1xuICAgIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgICBfZXJyb3JzKHt9KTtcbiAgICAgIGRlbGV0ZSB0YXJnZXQuZXJyb3I7XG4gICAgICBkZWxldGUgdGFyZ2V0LmVycm9ycztcbiAgICAgIGRlbGV0ZSB0YXJnZXQuaGFzRXJyb3I7XG4gICAgICBkZWxldGUgdGFyZ2V0Ll9kaXNwb3NlRmFsbGlibGU7XG4gICAgfTtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuICBrby5leHRlbmRlcnMuZmFsbGlibGUuaXNGYWxsaWJsZSA9IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgIHJldHVybiAodGFyZ2V0LmVycm9ycyAhPSBudWxsKSAmJiAodGFyZ2V0LmVycm9yICE9IG51bGwpO1xuICB9O1xuICBrby5wdXJlRXJyb3JzID0gZnVuY3Rpb24ocmVhZCwgb3duZXIpIHtcbiAgICB2YXIgY29tcHV0ZWQsIHN1YnNjcmlwdGlvbjtcbiAgICBzdWJzY3JpcHRpb24gPSB2b2lkIDA7XG4gICAgY29tcHV0ZWQgPSBrby5wdXJlQ29tcHV0ZWQoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYWRkRXJyb3IsIGRpc3Bvc2UsIGVycm9ycztcbiAgICAgIGVycm9ycyA9IFtdO1xuICAgICAgYWRkRXJyb3IgPSBmdW5jdGlvbih0YXJnZXQsIG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKHRhcmdldCAhPSBudWxsKSB7XG4gICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LmV4dGVuZCh7XG4gICAgICAgICAgICBmYWxsaWJsZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGVycm9ycy5wdXNoKHRhcmdldC5lcnJvcnMuYWRkKG1lc3NhZ2UpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaXNEaXNwb3NlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgZGlzcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZXJyb3IsIGksIGxlbjtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gZXJyb3JzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgZXJyb3IgPSBlcnJvcnNbaV07XG4gICAgICAgICAgZXJyb3IuZGlzcG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVycm9ycyA9IFtdO1xuICAgICAgICBzdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgICBzdWJzY3JpcHRpb24gPSB2b2lkIDA7XG4gICAgICB9O1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVhZC5jYWxsKG93bmVyLCBhZGRFcnJvcik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBzdWJzY3JpcHRpb24gPSBjb21wdXRlZC5zdWJzY3JpYmUoZGlzcG9zZSwgbnVsbCwgJ2FzbGVlcCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGVycm9ycztcbiAgICB9KTtcbiAgICByZXR1cm4gY29tcHV0ZWQ7XG4gIH07XG4gIHJldHVybiBrbztcbn07XG5cclxucmV0dXJuIGFwcGx5S292O1xyXG59KSk7XHJcbiIsImFwcGx5S292ID0gKGtvKSAtPlxyXG4gIGtvLmV4dGVuZGVycy5mYWxsaWJsZSA9ICh0YXJnZXQsIG9wdGlvbnMpIC0+XHJcbiAgICAjIERpc3Bvc2U/XHJcbiAgICBpZiBvcHRpb25zID09IGZhbHNlXHJcbiAgICAgIHRhcmdldC5fZGlzcG9zZUZhbGxpYmxlPygpXHJcbiAgICAgIHJldHVybiB0YXJnZXRcclxuXHJcbiAgICAjIEFscmVhZHkgY29uc3RydWN0ZWRcclxuICAgIGlmIGtvLmV4dGVuZGVycy5mYWxsaWJsZS5pc0ZhbGxpYmxlKHRhcmdldClcclxuICAgICAgcmV0dXJuIHRhcmdldFxyXG5cclxuICAgICMgY29udGFpbnMgdGhlIGVycm9ycyBmb3IgdGFyZ2V0XHJcbiAgICBfZXJyb3JzID0ga28ub2JzZXJ2YWJsZSh7fSlcclxuXHJcbiAgICAjIHVzZWQgZm9yIGdlbmVyYXRpbmcgYSB1bmlxdWUgaWQgZm9yIGVhY2ggZXJyb3JcclxuICAgIF9pZENvdW50ZXIgPSAwXHJcblxyXG4gICAgIyBoZWxwZXIgZm9yIGNhbGxpbmcgaGFzT3duUHJvcGVydHlcclxuICAgIF9oYXNPd25Qcm9wID0gKHt9KS5oYXNPd25Qcm9wZXJ0eVxyXG5cclxuICAgICMgUmVtb3ZlcyB0aGUgc3BlY2lmaWVkIGVycm9yLCBpZiBpdCBleGlzdHNcclxuICAgIF9yZW1vdmVFcnJvciA9IChpZCkgLT5cclxuICAgICAgZXJyb3JzID0gX2Vycm9ycygpXHJcblxyXG4gICAgICBpZiBfaGFzT3duUHJvcC5jYWxsKGVycm9ycywgaWQpXHJcbiAgICAgICAgZGVsZXRlIGVycm9yc1tpZF1cclxuICAgICAgICBfZXJyb3JzLnZhbHVlSGFzTXV0YXRlZCgpXHJcblxyXG4gICAgICByZXR1cm5cclxuXHJcbiAgICAjIFJldHVybnMgdHJ1ZSBpZmYgdGhlIHNwZWNpZmllZCBlcnJvciBleGlzdHNcclxuICAgIF9lcnJvckV4aXN0cyA9IChpZCkgLT5cclxuICAgICAgX2hhc093blByb3AuY2FsbChfZXJyb3JzKCksIGlkKVxyXG5cclxuICAgIF9lcnJvck1ldGFEYXRhID0gKGVycm9ycywgaWQsIG1lc3NhZ2UpIC0+XHJcbiAgICAgIGlmIGlkP1xyXG4gICAgICAgIG1ldGFEYXRhID0ge1xyXG4gICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxyXG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXRcclxuICAgICAgICAgIGRpc3Bvc2U6ICgpIC0+XHJcbiAgICAgICAgICAgIF9yZW1vdmVFcnJvcihpZClcclxuICAgICAgICAgIGlzRGlzcG9zZWQ6ICgpIC0+XHJcbiAgICAgICAgICAgIG5vdCBfZXJyb3JFeGlzdHMoaWQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVycm9yc1tpZF0gPSBtZXNzYWdlXHJcbiAgICAgIGVsc2VcclxuICAgICAgICBtZXRhRGF0YSA9IHtcclxuICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcclxuICAgICAgICAgIHRhcmdldDogdGFyZ2V0XHJcbiAgICAgICAgICBkaXNwb3NlOiAoKSAtPiB1bmRlZmluZWRcclxuICAgICAgICAgIGlzRGlzcG9zZWQ6ICgpIC0+IHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gbWV0YURhdGFcclxuXHJcbiAgICAjIEEgbGlzdCBvZiBhbGwgZXJyb3JzXHJcbiAgICB0YXJnZXQuZXJyb3JzID0ga28ucHVyZUNvbXB1dGVkKHtcclxuICAgICAgcmVhZDogKCkgLT5cclxuICAgICAgICBtZXNzYWdlcyA9IFtdXHJcblxyXG4gICAgICAgIGFkZE1lc3NhZ2UgPSAobWVzc2FnZSkgLT5cclxuICAgICAgICAgIGlmIG5vdCBtZXNzYWdlP1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgIGVsc2UgaWYgdHlwZW9mIG1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJ1xyXG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSgpXHJcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UobWVzc2FnZSlcclxuICAgICAgICAgIGVsc2UgaWYgQXJyYXkuaXNBcnJheShtZXNzYWdlKVxyXG4gICAgICAgICAgICBmb3Igc3ViTWVzc2FnZSBpbiBtZXNzYWdlXHJcbiAgICAgICAgICAgICAgYWRkTWVzc2FnZShzdWJNZXNzYWdlKVxyXG4gICAgICAgICAgZWxzZSBpZiB0eXBlb2YgbWVzc2FnZSA9PSAnc3RyaW5nJyBvciB0eXBlb2YgbWVzc2FnZSA9PSAnb2JqZWN0J1xyXG4gICAgICAgICAgICBtZXNzYWdlcy5wdXNoKG1lc3NhZ2UpXHJcbiAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGNvbnNvbGU/LmFzc2VydD8oZmFsc2UsICdpbnZhbGlkIGVycm9yIG1lc3NhZ2UnKVxyXG5cclxuICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBmb3Igb3duIGlkLCBtZXNzYWdlIG9mIF9lcnJvcnMoKVxyXG4gICAgICAgICAgYWRkTWVzc2FnZShtZXNzYWdlKVxyXG5cclxuICAgICAgICByZXR1cm4gbWVzc2FnZXNcclxuXHJcbiAgICAgIHdyaXRlOiAobWVzc2FnZXMpIC0+XHJcbiAgICAgICAgdGFyZ2V0LmVycm9ycy5zZXQobWVzc2FnZXMpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9KVxyXG5cclxuICAgICMgQWRkIGFuIGluZGl2aWR1YWwgZXJyb3JcclxuICAgIHRhcmdldC5lcnJvcnMuYWRkID0gKG1lc3NhZ2UpIC0+XHJcbiAgICAgIGlmIG1lc3NhZ2U/XHJcbiAgICAgICAgaWQgPSArK19pZENvdW50ZXJcclxuXHJcbiAgICAgIG1ldGFEYXRhID0gX2Vycm9yTWV0YURhdGEoX2Vycm9ycygpLCBpZCwgbWVzc2FnZSlcclxuICAgICAgX2Vycm9ycy52YWx1ZUhhc011dGF0ZWQoKVxyXG5cclxuICAgICAgcmV0dXJuIG1ldGFEYXRhXHJcblxyXG4gICAgIyBHZXQgdGhlIGZpcnN0IGVycm9yXHJcbiAgICB0YXJnZXQuZXJyb3JzLmdldCA9ICgpIC0+XHJcbiAgICAgIGZpcnN0TWVzc2FnZSA9IHVuZGVmaW5lZFxyXG5cclxuICAgICAgZmluZE1lc3NhZ2UgPSAobWVzc2FnZSkgLT5cclxuICAgICAgICBpZiBub3QgbWVzc2FnZT9cclxuICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIGVsc2UgaWYgdHlwZW9mIG1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJ1xyXG4gICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UoKVxyXG4gICAgICAgICAgaWYgZmluZE1lc3NhZ2UobWVzc2FnZSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICBlbHNlIGlmIEFycmF5LmlzQXJyYXkobWVzc2FnZSlcclxuICAgICAgICAgIGZvciBzdWJNZXNzYWdlIGluIG1lc3NhZ2VcclxuICAgICAgICAgICAgaWYgZmluZE1lc3NhZ2Uoc3ViTWVzc2FnZSlcclxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIGVsc2UgaWYgdHlwZW9mIG1lc3NhZ2UgPT0gJ3N0cmluZycgb3IgdHlwZW9mIG1lc3NhZ2UgPT0gJ29iamVjdCdcclxuICAgICAgICAgIGZpcnN0TWVzc2FnZSA9IG1lc3NhZ2VcclxuICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgY29uc29sZT8uYXNzZXJ0PyhmYWxzZSwgJ2ludmFsaWQgZXJyb3IgbWVzc2FnZScpXHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG5cclxuICAgICAgZm9yIG93biBpZCwgbWVzc2FnZSBvZiBfZXJyb3JzKClcclxuICAgICAgICBpZiBmaW5kTWVzc2FnZShtZXNzYWdlKVxyXG4gICAgICAgICAgcmV0dXJuIGZpcnN0TWVzc2FnZVxyXG5cclxuICAgICAgcmV0dXJuIHVuZGVmaW5lZFxyXG5cclxuICAgICMgU2V0IGEgc2luZ2xlIGVycm9yLCBjbGVhcmluZyBvdGhlciBlcnJvcnNcclxuICAgIHRhcmdldC5lcnJvcnMuc2V0ID0gKG1lc3NhZ2UpIC0+XHJcbiAgICAgIGlmIG1lc3NhZ2U/XHJcbiAgICAgICAgaWQgPSArK19pZENvdW50ZXJcclxuXHJcbiAgICAgIGVycm9ycyA9IHt9XHJcbiAgICAgIG1ldGFEYXRhID0gX2Vycm9yTWV0YURhdGEoZXJyb3JzLCBpZCwgbWVzc2FnZSlcclxuICAgICAgX2Vycm9ycyhlcnJvcnMpXHJcbiAgICAgIHJldHVybiBtZXRhRGF0YVxyXG5cclxuICAgIHRhcmdldC5lcnJvcnMuaGFzID0gKCkgLT5cclxuICAgICAgcmV0dXJuIHRhcmdldC5lcnJvcigpP1xyXG5cclxuICAgICMgQ2xlYXIgYWxsIHRoZSBjdXJyZW50IGVycm9yc1xyXG4gICAgdGFyZ2V0LmVycm9ycy5jbGVhciA9ICgpIC0+XHJcbiAgICAgIF9lcnJvcnMoe30pXHJcbiAgICAgIHJldHVyblxyXG5cclxuICAgICMgR2V0IHRoZSBmaXJzdCBlcnJvciwgb3IgU2V0IGEgc2luZ2xlIGVycm9yIHdoaWxzdCBjbGVhcmluZyBvdGhlciBlcnJvcnNcclxuICAgIHRhcmdldC5lcnJvciA9IGtvLnB1cmVDb21wdXRlZCh7XHJcbiAgICAgIHJlYWQ6IHRhcmdldC5lcnJvcnMuZ2V0XHJcbiAgICAgIHdyaXRlOiB0YXJnZXQuZXJyb3JzLnNldFxyXG4gICAgfSlcclxuXHJcbiAgICAjIFJldHVybiB0cnVlIGlmZiB0aGVyZSBhcmUgYW55IGVycm9yc1xyXG4gICAgdGFyZ2V0Lmhhc0Vycm9yID0ga28ucHVyZUNvbXB1dGVkKHtcclxuICAgICAgcmVhZDogdGFyZ2V0LmVycm9ycy5oYXNcclxuICAgIH0pXHJcblxyXG4gICAgIyBSZW1vdmUgZmFsbGlibGUgZGF0YSBmcm9tIHRoZSB0YXJnZXQgb2JqZWN0XHJcbiAgICB0YXJnZXQuX2Rpc3Bvc2VGYWxsaWJsZSA9ICgpIC0+XHJcbiAgICAgIF9lcnJvcnMoe30pXHJcbiAgICAgIGRlbGV0ZSB0YXJnZXQuZXJyb3JcclxuICAgICAgZGVsZXRlIHRhcmdldC5lcnJvcnNcclxuICAgICAgZGVsZXRlIHRhcmdldC5oYXNFcnJvclxyXG4gICAgICBkZWxldGUgdGFyZ2V0Ll9kaXNwb3NlRmFsbGlibGVcclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgcmV0dXJuIHRhcmdldFxyXG5cclxuICAjIERldGVybWluZSBpZiBpdGVtIGlzIGZhbGxpYmxlXHJcbiAga28uZXh0ZW5kZXJzLmZhbGxpYmxlLmlzRmFsbGlibGUgPSAodGFyZ2V0KSAtPlxyXG4gICAgcmV0dXJuIHRhcmdldC5lcnJvcnM/IGFuZCB0YXJnZXQuZXJyb3I/XHJcblxyXG4gIGtvLnB1cmVFcnJvcnMgPSAocmVhZCwgb3duZXIpIC0+XHJcbiAgICBzdWJzY3JpcHRpb24gPSB1bmRlZmluZWRcclxuXHJcbiAgICBjb21wdXRlZCA9IGtvLnB1cmVDb21wdXRlZChcclxuICAgICAgKCkgLT5cclxuICAgICAgICBlcnJvcnMgPSBbXVxyXG4gICAgICAgIGFkZEVycm9yID0gKHRhcmdldCwgbWVzc2FnZSkgLT5cclxuICAgICAgICAgIGlmIHRhcmdldD9cclxuICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LmV4dGVuZCh7IGZhbGxpYmxlOiB0cnVlIH0pXHJcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKHRhcmdldC5lcnJvcnMuYWRkKG1lc3NhZ2UpKVxyXG4gICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxyXG4gICAgICAgICAgICAgIGRpc3Bvc2U6ICgpIC0+IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgIGlzRGlzcG9zZWQ6ICgpIC0+IHRydWVcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgZGlzcG9zZSA9ICgpIC0+XHJcbiAgICAgICAgICBmb3IgZXJyb3IgaW4gZXJyb3JzXHJcbiAgICAgICAgICAgIGVycm9yLmRpc3Bvc2UoKVxyXG4gICAgICAgICAgZXJyb3JzID0gW11cclxuICAgICAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKClcclxuICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHRyeVxyXG4gICAgICAgICAgcmVhZC5jYWxsKG93bmVyLCBhZGRFcnJvcilcclxuICAgICAgICBmaW5hbGx5XHJcbiAgICAgICAgICBzdWJzY3JpcHRpb24gPSBjb21wdXRlZC5zdWJzY3JpYmUoZGlzcG9zZSwgbnVsbCwgJ2FzbGVlcCcpXHJcblxyXG4gICAgICAgIHJldHVybiBlcnJvcnNcclxuICAgIClcclxuXHJcbiAgICByZXR1cm4gY29tcHV0ZWRcclxuXHJcbiAgcmV0dXJuIGtvXHJcblxyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
